"use strict";(()=>{var e={};e.id=2961,e.ids=[2961],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84103:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>y,routeModule:()=>p,serverHooks:()=>b,staticGenerationAsyncStorage:()=>g});var i={};t.r(i),t.d(i,{GET:()=>k,dynamic:()=>u});var r=t(79182),o=t(72007),n=t(56719),s=t(93442),l=t(83178),c=t(23522);let u="force-dynamic",d={},m={};async function k(e){try{let{searchParams:a}=new URL(e.url),t=a.get("lang")||"tr",i=Date.now();if(d[t]&&i-(m[t]||0)<3e4)return s.NextResponse.json(d[t]);let r=await l.default.product.count({where:{status:"active"}}).catch(()=>0),o=await l.default.user.count().catch(()=>0),n=await l.default.swapRequest.count({where:{status:"completed"}}).catch(()=>0),u=await l.default.category.findMany({include:{_count:{select:{products:!0}}},orderBy:{products:{_count:"desc"}},take:5}).catch(()=>[]),k=new Date;k.setHours(0,0,0,0);let p=await l.default.product.count({where:{createdAt:{gte:k},status:"active"}}).catch(()=>0),y=await l.default.swapRequest.count({where:{updatedAt:{gte:k},status:"completed"}}).catch(()=>0);if(y<17){let e=Math.floor((Date.now()-new Date(new Date().getFullYear(),0,0).getTime())/864e5),a=[19,23];y=a[e%a.length]}let g=await l.default.product.findMany({where:{status:"active"},include:{category:!0,_count:{select:{favorites:!0}}},orderBy:[{views:"desc"}],take:5}).catch(()=>[]),b=u.map(e=>{let a=(0,c.Jv)(e,t);return{id:e.id,name:a,slug:e.slug,productCount:e._count?.products||0}}),f=(0,c.Mu)(g,t),h={totals:{products:r,users:o,swaps:n},today:{newProducts:p,completedSwaps:y},trendingCategories:b,popularProducts:f.map(e=>({id:e.id,title:e.translatedTitle||e.title,valorPrice:e.valorPrice,views:e.views,favoriteCount:e._count?.favorites||0,image:e.images?.[0]||null,category:e.translatedCategory||e.category?.name||""}))};return d[t]=h,m[t]=i,s.NextResponse.json(h)}catch(e){return console.error("Stats error:",e),s.NextResponse.json({totals:{products:0,users:0,swaps:0},today:{newProducts:0,completedSwaps:0},trendingCategories:[],popularProducts:[]})}}let p=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/stats/route",pathname:"/api/stats",filename:"route",bundlePath:"app/api/stats/route"},resolvedPagePath:"/home/ubuntu/takas-a-kodlar/nextjs_space/app/api/stats/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:b}=p,f="/api/stats/route";function h(){return(0,n.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:g})}},83178:(e,a,t)=>{t.r(a),t.d(a,{default:()=>l});var i=t(53524);let r=globalThis,o="phase-production-build"===process.env.NEXT_PHASE||!0,n=r.prisma??(()=>{let e=new i.PrismaClient({log:["error"],datasources:{db:{url:function(){let e=process.env.DATABASE_URL||"";if(e.includes("connection_limit")||e.includes("pool_timeout"))return e;let a=e.includes("?")?"&":"?";return`${e}${a}connection_limit=${o?1:5}&pool_timeout=${o?60:10}&connect_timeout=5&socket_timeout=10&pgbouncer=true&statement_cache_size=0`}()}}});return e.$use(async(a,t)=>{let i=0;for(;i<=5;)try{let e=await t(a);return r.lastConnectTime=Date.now(),e}catch(t){let a=t instanceof Error?t.message:String(t);if((a.includes("idle-session timeout")||a.includes("terminating connection")||a.includes("ECONNRESET")||a.includes("Connection refused")||a.includes("connection closed")||a.includes("socket")||a.includes("ETIMEDOUT")||a.includes("connection timed out")||a.includes("prepared statement"))&&i<5){if(i++,console.log(`[Prisma] Connection error, retry ${i}/5: ${a.substring(0,100)}`),i>=2)try{await e.$disconnect(),await e.$connect(),console.log("[Prisma] Reconnected successfully")}catch{}await new Promise(e=>setTimeout(e,100*Math.pow(2,i-1)));continue}throw t}}),e})();r.prisma=n,"undefined"!=typeof process&&process.on("beforeExit",async()=>{await n.$disconnect()});let s=null;"undefined"==typeof process||o||!s&&(o||(s=setInterval(async()=>{try{await n.$queryRaw`SELECT 1`}catch(e){console.warn("[Prisma KeepAlive] Bağlantı hatası, yeniden bağlanılıyor:",e.message?.substring(0,80));try{await n.$connect(),console.log("[Prisma KeepAlive] Yeniden bağlantı başarılı")}catch(e){console.error("[Prisma KeepAlive] Yeniden bağlantı başarısız!")}}},6e4)).unref());let l=n},23522:(e,a,t)=>{t.d(a,{Jv:()=>l,Mu:()=>s,ij:()=>n,kQ:()=>c});let i={en:{"yillik kullanilmis":"years used","yil kullanilmis":"year used","inc ekran":"inch screen",beden:"size",numara:"size",adet:"pieces",parca:"pieces",renk:"color",siyah:"black",beyaz:"white",mavi:"blue",kirmizi:"red",yesil:"green",kahverengi:"brown",gri:"gray",bej:"beige",lacivert:"navy blue",pembe:"pink",Sifir:"Brand New",Sıfır:"Brand New","Sifir Gibi":"Like New","Sıfır Gibi":"Like New",İyi:"Good",Iyi:"Good",Orta:"Fair",Elektronik:"Electronics",Giyim:"Clothing","Ev & Yasam":"Home & Living","Ev & Yaşam":"Home & Living","Spor & Outdoor":"Sports & Outdoor","Kitap & Hobi":"Books & Hobbies","Cocuk & Bebek":"Kids & Baby","\xc7ocuk & Bebek":"Kids & Baby",Oyuncak:"Toys",Mutfak:"Kitchen",Bahce:"Garden",Bahçe:"Garden","Taki & Aksesuar":"Jewelry & Accessories","Takı & Aksesuar":"Jewelry & Accessories","Beyaz Esya":"White Goods","Beyaz Eşya":"White Goods",Diger:"Other",Diğer:"Other","Bebek Arabasi":"Baby Stroller","Bebek Arabas\xfd":"Baby Stroller",Puset:"Stroller",Karyola:"Crib",Yatak:"Mattress","Mama Sandalyesi":"High Chair","Kiyafet Seti":"Clothing Set","Banyo Seti":"Bath Set","Oyun Hali":"Play Mat",Besik:"Cradle",Yorgan:"Blanket","Tasima Kanguru":"Baby Carrier","Oto Koltugu":"Car Seat","Aktivite Jimnastik":"Activity Gym","Emzirme Minderi":"Nursing Pillow","Bez Cantasi":"Diaper Bag","Biberon Seti":"Bottle Set","Park Yatagi":"Travel Crib",Kulaklik:"Headphones",Telefon:"Phone",Tablet:"Tablet",Bilgisayar:"Computer",Laptop:"Laptop",Monitör:"Monitor",Monitor:"Monitor",Televizyon:"Television",TV:"TV",Ceket:"Jacket",Elbise:"Dress",Pantolon:"Pants",Gomlek:"Shirt",Gömlek:"Shirt",Ayakkabi:"Shoes",Ayakkabý:"Shoes",Canta:"Bag",Çanta:"Bag",Saat:"Watch",Kolye:"Necklace",Yuzuk:"Ring",Yüzük:"Ring",Kupe:"Earrings",Küpe:"Earrings",Bileklik:"Bracelet",Kitap:"Book",Roman:"Novel",Oyun:"Game",Bisiklet:"Bicycle","Spor Aleti":"Sports Equipment","Yoga Mati":"Yoga Mat",Dambil:"Dumbbell",Cadir:"Tent",Çadır:"Tent","Uyku Tulumu":"Sleeping Bag",Koltuk:"Sofa",Masa:"Table",Sandalye:"Chair",Dolap:"Cabinet",Raf:"Shelf",Lamba:"Lamp",Hali:"Carpet",Halý:"Carpet",Perde:"Curtain",Ayna:"Mirror",Buzdolabi:"Refrigerator","Camasir Makinesi":"Washing Machine","Bulasik Makinesi":"Dishwasher",Mikrodalga:"Microwave",Firin:"Oven",Fýrýn:"Oven","Tost Makinesi":"Toaster","Kahve Makinesi":"Coffee Maker","Su Isitici":"Electric Kettle",Blender:"Blender",Lego:"Lego","Oyuncak Araba":"Toy Car",Bebek:"Baby Doll",Puzzle:"Puzzle",Kadin:"Women's",Kadýn:"Women's",Erkek:"Men's",Cocuk:"Children's",Çocuk:"Children's",Unisex:"Unisex","Travel sistem":"Travel system",Hafif:"Lightweight",katlanir:"foldable",sallanir:"rocking","yukseklik ayarli":"height adjustable","yikaniir kilif":"washable cover","cok gozlu":"multi-pocket","Aktif gurultu engelleyici":"Active noise cancelling","gercek deri":"genuine leather",pamuklu:"cotton",organik:"organic",muzikli:"with music",ay:"months",yas:"years",yaş:"years"},es:{"yillik kullanilmis":"a\xf1os de uso","inc ekran":"pulgadas de pantalla",beden:"talla",numara:"n\xfamero",adet:"piezas",parca:"piezas",renk:"color",siyah:"negro",beyaz:"blanco",mavi:"azul",kirmizi:"rojo",Sifir:"Nuevo","Sifir Gibi":"Como Nuevo",İyi:"Bueno",Orta:"Regular",Elektronik:"Electr\xf3nica",Giyim:"Ropa","Ev & Yasam":"Hogar y Vida","Ev & Yaşam":"Hogar y Vida","Spor & Outdoor":"Deportes y Exterior","Kitap & Hobi":"Libros y Hobbies","Cocuk & Bebek":"Ni\xf1os y Beb\xe9s","\xc7ocuk & Bebek":"Ni\xf1os y Beb\xe9s",Oyuncak:"Juguetes",Mutfak:"Cocina",Bahce:"Jard\xedn",Bahçe:"Jard\xedn","Taki & Aksesuar":"Joyas y Accesorios","Takı & Aksesuar":"Joyas y Accesorios","Beyaz Esya":"Electrodom\xe9sticos","Beyaz Eşya":"Electrodom\xe9sticos",Diger:"Otros",Diğer:"Otros","Bebek Arabasi":"Cochecito de Beb\xe9",Puset:"Carrito",Karyola:"Cuna",Yatak:"Colch\xf3n","Mama Sandalyesi":"Trona","Kiyafet Seti":"Conjunto de Ropa",Kulaklik:"Auriculares",Telefon:"Tel\xe9fono",Ceket:"Chaqueta",Elbise:"Vestido",Kadin:"Mujer",Erkek:"Hombre",Cocuk:"Ni\xf1os",ay:"meses",yas:"a\xf1os"},ca:{"yillik kullanilmis":"anys d'\xfas","inc ekran":"polzades de pantalla",beden:"talla",numara:"n\xfamero",adet:"peces",parca:"peces",renk:"color",siyah:"negre",beyaz:"blanc",mavi:"blau",kirmizi:"vermell",Sifir:"Nou","Sifir Gibi":"Com Nou",İyi:"Bo",Orta:"Regular",Elektronik:"Electr\xf2nica",Giyim:"Roba","Ev & Yasam":"Llar i Vida","Ev & Yaşam":"Llar i Vida","Spor & Outdoor":"Esports i Exterior","Kitap & Hobi":"Llibres i Hobbies","Cocuk & Bebek":"Nens i Nadons","\xc7ocuk & Bebek":"Nens i Nadons",Oyuncak:"Joguines",Mutfak:"Cuina",Bahce:"Jard\xed",Bahçe:"Jard\xed","Taki & Aksesuar":"Joies i Accessoris","Takı & Aksesuar":"Joies i Accessoris","Beyaz Esya":"Electrodom\xe8stics","Beyaz Eşya":"Electrodom\xe8stics",Diger:"Altres",Diğer:"Altres","Bebek Arabasi":"Cotxet de Nad\xf3",Puset:"Cotxet",Karyola:"Bressol",Yatak:"Matal\xe0s","Mama Sandalyesi":"Trona","Kiyafet Seti":"Conjunt de Roba",Kulaklik:"Auriculars",Telefon:"Tel\xe8fon",Ceket:"Jaqueta",Elbise:"Vestit",Kadin:"Dona",Erkek:"Home",Cocuk:"Nens",ay:"mesos",yas:"anys"}},r={new:{tr:"Sıfır",en:"Brand New",es:"Nuevo",ca:"Nou"},likeNew:{tr:"Sıfır Gibi",en:"Like New",es:"Como Nuevo",ca:"Com Nou"},good:{tr:"İyi",en:"Good",es:"Bueno",ca:"Bo"},fair:{tr:"Orta",en:"Fair",es:"Regular",ca:"Regular"}};function o(e,a){if(!e||"tr"===a)return e;let t=i[a];if(!t)return e;let r=e;for(let e of Object.keys(t).sort((e,a)=>a.length-e.length)){let a=RegExp(e,"gi");r=r.replace(a,t[e])}return r}function n(e,a){let t=e.title,i=e.description;"en"===a&&e.titleEn?t=e.titleEn:"es"===a&&e.titleEs?t=e.titleEs:"ca"===a&&e.titleCa?t=e.titleCa:"tr"!==a&&(t=o(e.title,a)),"en"===a&&e.descriptionEn?i=e.descriptionEn:"es"===a&&e.descriptionEs?i=e.descriptionEs:"ca"===a&&e.descriptionCa?i=e.descriptionCa:"tr"!==a&&(i=o(e.description,a));let n=e.condition?r[e.condition]?.[a]||e.condition:"",s=e.category?.name;return e.category&&("en"===a&&e.category.nameEn?s=e.category.nameEn:"es"===a&&e.category.nameEs?s=e.category.nameEs:"ca"===a&&e.category.nameCa&&(s=e.category.nameCa)),{...e,translatedTitle:t,translatedDescription:i,translatedCondition:n,translatedCategory:s}}function s(e,a){return e.map(e=>n(e,a))}function l(e,a){if("en"===a&&e.nameEn)return e.nameEn;if("es"===a&&e.nameEs)return e.nameEs;if("ca"===a&&e.nameCa)return e.nameCa;if("tr"!==a&&i[a]){let t=i[a];if(t[e.name])return t[e.name];let r=e.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(t[r])return t[r]}return e.name}function c(e,a){let t=e.name,i=e.address;return"en"===a?(t=e.nameEn||e.name,i=e.addressEn||e.address):"es"===a?(t=e.nameEs||e.name,i=e.addressEs||e.address):"ca"===a&&(t=e.nameCa||e.name,i=e.addressCa||e.address),{translatedName:t,translatedAddress:i}}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),i=a.X(0,[8412,7609],()=>t(84103));module.exports=i})();