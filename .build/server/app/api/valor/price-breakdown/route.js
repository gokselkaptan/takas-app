"use strict";(()=>{var e={};e.id=9611,e.ids=[9611],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},77124:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>w,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{GET:()=>u,dynamic:()=>l});var o=r(79182),a=r(72007),i=r(56719),s=r(93442),c=r(89710);let l="force-dynamic";async function u(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("valor")||"0"),n=t.get("city")||"İzmir";if(r<=0)return s.NextResponse.json({error:"Ge\xe7erli valor değeri gerekli"},{status:400});let o=await (0,c.Xn)(r,n);return s.NextResponse.json(o)}catch(e){return console.error("Price breakdown error:",e),s.NextResponse.json({error:"Fiyat hesaplanamadı"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/valor/price-breakdown/route",pathname:"/api/valor/price-breakdown",filename:"route",bundlePath:"app/api/valor/price-breakdown/route"},resolvedPagePath:"/home/ubuntu/takas-a-kodlar/nextjs_space/app/api/valor/price-breakdown/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:w}=d,v="/api/valor/price-breakdown/route";function f(){return(0,i.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:m})}},83178:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var n=r(53524);let o=globalThis,a="phase-production-build"===process.env.NEXT_PHASE||!0,i=o.prisma??(()=>{let e=new n.PrismaClient({log:["error"],datasources:{db:{url:function(){let e=process.env.DATABASE_URL||"";if(e.includes("connection_limit")||e.includes("pool_timeout"))return e;let t=e.includes("?")?"&":"?";return`${e}${t}connection_limit=${a?1:5}&pool_timeout=${a?60:10}&connect_timeout=5&socket_timeout=10&pgbouncer=true&statement_cache_size=0`}()}}});return e.$use(async(t,r)=>{let n=0;for(;n<=5;)try{let e=await r(t);return o.lastConnectTime=Date.now(),e}catch(r){let t=r instanceof Error?r.message:String(r);if((t.includes("idle-session timeout")||t.includes("terminating connection")||t.includes("ECONNRESET")||t.includes("Connection refused")||t.includes("connection closed")||t.includes("socket")||t.includes("ETIMEDOUT")||t.includes("connection timed out")||t.includes("prepared statement"))&&n<5){if(n++,console.log(`[Prisma] Connection error, retry ${n}/5: ${t.substring(0,100)}`),n>=2)try{await e.$disconnect(),await e.$connect(),console.log("[Prisma] Reconnected successfully")}catch{}await new Promise(e=>setTimeout(e,100*Math.pow(2,n-1)));continue}throw r}}),e})();o.prisma=i,"undefined"!=typeof process&&process.on("beforeExit",async()=>{await i.$disconnect()});let s=null;"undefined"==typeof process||a||!s&&(a||(s=setInterval(async()=>{try{await i.$queryRaw`SELECT 1`}catch(e){console.warn("[Prisma KeepAlive] Bağlantı hatası, yeniden bağlanılıyor:",e.message?.substring(0,80));try{await i.$connect(),console.log("[Prisma KeepAlive] Yeniden bağlantı başarılı")}catch(e){console.error("[Prisma KeepAlive] Yeniden bağlantı başarısız!")}}},6e4)).unref());let c=i}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8412,7609,9710],()=>r(77124));module.exports=n})();