"use strict";(()=>{var e={};e.id=8829,e.ids=[8829],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57078:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>y,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var n={};a.r(n),a.d(n,{GET:()=>d,dynamic:()=>l,revalidate:()=>u});var s=a(79182),r=a(72007),o=a(56719),i=a(93442),c=a(83178);let l="force-dynamic",u=0;async function d(){let e=Date.now(),t={status:"ok",timestamp:new Date().toISOString(),uptime:process.uptime(),version:process.env.npm_package_version||"1.0.0"};try{let e=Date.now();await c.default.$queryRaw`SELECT 1 as health`,t.database={status:"ok",responseTime:Date.now()-e+"ms"}}catch(e){t.database={status:"error",error:e.message?.substring(0,100)},t.status="degraded"}let a=process.memoryUsage();t.memory={heapUsed:Math.round(a.heapUsed/1024/1024)+"MB",heapTotal:Math.round(a.heapTotal/1024/1024)+"MB",rss:Math.round(a.rss/1024/1024)+"MB"},a.heapUsed>536870912&&(t.memoryWarning="Y\xfcksek bellek kullanımı!",t.status="degraded"),t.totalResponseTime=Date.now()-e+"ms";let n="ok"===t.status?200:503;return i.NextResponse.json(t,{status:n,headers:{"Cache-Control":"no-store, no-cache, must-revalidate"}})}let p=new s.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/health/route",pathname:"/api/health",filename:"route",bundlePath:"app/api/health/route"},resolvedPagePath:"/home/ubuntu/takas-a-kodlar/nextjs_space/app/api/health/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:g}=p,y="/api/health/route";function w(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},83178:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var n=a(53524);let s=globalThis,r="phase-production-build"===process.env.NEXT_PHASE||!0,o=s.prisma??(()=>{let e=new n.PrismaClient({log:["error"],datasources:{db:{url:function(){let e=process.env.DATABASE_URL||"";if(e.includes("connection_limit")||e.includes("pool_timeout"))return e;let t=e.includes("?")?"&":"?";return`${e}${t}connection_limit=${r?1:5}&pool_timeout=${r?60:10}&connect_timeout=5&socket_timeout=10&pgbouncer=true&statement_cache_size=0`}()}}});return e.$use(async(t,a)=>{let n=0;for(;n<=5;)try{let e=await a(t);return s.lastConnectTime=Date.now(),e}catch(a){let t=a instanceof Error?a.message:String(a);if((t.includes("idle-session timeout")||t.includes("terminating connection")||t.includes("ECONNRESET")||t.includes("Connection refused")||t.includes("connection closed")||t.includes("socket")||t.includes("ETIMEDOUT")||t.includes("connection timed out")||t.includes("prepared statement"))&&n<5){if(n++,console.log(`[Prisma] Connection error, retry ${n}/5: ${t.substring(0,100)}`),n>=2)try{await e.$disconnect(),await e.$connect(),console.log("[Prisma] Reconnected successfully")}catch{}await new Promise(e=>setTimeout(e,100*Math.pow(2,n-1)));continue}throw a}}),e})();s.prisma=o,"undefined"!=typeof process&&process.on("beforeExit",async()=>{await o.$disconnect()});let i=null;"undefined"==typeof process||r||!i&&(r||(i=setInterval(async()=>{try{await o.$queryRaw`SELECT 1`}catch(e){console.warn("[Prisma KeepAlive] Bağlantı hatası, yeniden bağlanılıyor:",e.message?.substring(0,80));try{await o.$connect(),console.log("[Prisma KeepAlive] Yeniden bağlantı başarılı")}catch(e){console.error("[Prisma KeepAlive] Yeniden bağlantı başarısız!")}}},6e4)).unref());let c=o}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[8412,7609],()=>a(57078));module.exports=n})();