"use strict";(()=>{var e={};e.id=8873,e.ids=[8873],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},67609:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>x,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{POST:()=>c});var i=r(79182),s=r(72007),n=r(56719),o=r(93442),u=r(3390),l=r.n(u),p=r(83178),d=r(59521);async function c(e){try{let{email:t,password:r,captchaToken:a}=await e.json(),i=(0,d.H9)(e),s=(0,d.ij)(e),n=await (0,d.d5)(i,t);if(!n.allowed)return o.NextResponse.json({error:"Hesabınız ge\xe7ici olarak kilitlendi",lockedUntil:n.lockedUntil?.toISOString(),remainingMinutes:n.lockedUntil?Math.ceil((n.lockedUntil.getTime()-Date.now())/6e4):30},{status:429});if(a&&process.env.RECAPTCHA_SECRET_KEY){let e=await (0,d.Sw)(a);if(!e.success)return await (0,d.oy)({eventType:"captcha_failed",ip:i,email:t,userAgent:s,severity:"medium",metadata:{score:e.score}}),o.NextResponse.json({error:"G\xfcvenlik doğrulaması başarısız"},{status:400})}let u=await p.default.user.findUnique({where:{email:t}});if(!u)return await (0,d.Vm)(i,t,s,"User not found"),o.NextResponse.json({error:"Ge\xe7ersiz email veya şifre",remainingAttempts:n.remainingAttempts-1},{status:401});if(!await l().compare(r,u.password))return await (0,d.Vm)(i,t,s,"Invalid password"),o.NextResponse.json({error:"Ge\xe7ersiz email veya şifre",remainingAttempts:n.remainingAttempts-1},{status:401});if(!u.emailVerified)return o.NextResponse.json({error:"L\xfctfen \xf6nce email adresinizi doğrulayın",requiresVerification:!0},{status:403});return await (0,d.LW)(i,u.id,t,s),await p.default.user.update({where:{id:u.id},data:{lastLoginAt:new Date}}),o.NextResponse.json({success:!0,message:"Giriş başarılı",user:{id:u.id,email:u.email,name:u.name,role:u.role}})}catch(e){return console.error("Login error:",e),o.NextResponse.json({error:"Giriş yapılırken bir hata oluştu"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/home/ubuntu/takas-a-kodlar/nextjs_space/app/api/auth/login/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:h}=m,w="/api/auth/login/route";function x(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8412,7609,3390,9521],()=>r(67609));module.exports=a})();