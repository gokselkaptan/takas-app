"use strict";(()=>{var e={};e.id=1050,e.ids=[1050],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},40825:(e,a,i)=>{i.r(a),i.d(a,{originalPathname:()=>b,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>k,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var t={};i.r(t),i.d(t,{GET:()=>y,dynamic:()=>d});var r=i(79182),n=i(72007),o=i(56719),s=i(93442),l=i(83178),c=i(23522),u=i(69767);let d="force-dynamic";async function y(e){try{let{searchParams:a}=new URL(e.url),i=a.get("lang")||"tr",t=a.get("district"),r=a.get("lat")?parseFloat(a.get("lat")):null,n=a.get("lon")?parseFloat(a.get("lon")):null;if(!r&&!n){let e=`delivery-points-${i}-${t||"all"}`,a=(0,u.lJ)(e);if(a)return s.NextResponse.json(a)}let o={isActive:!0};t&&(o.district=t);let d=(await l.default.deliveryPoint.findMany({where:o,orderBy:{name:"asc"}})).map(e=>({...e,...(0,c.kQ)(e,i),distance:r&&n?function(e,a,i,t){let r=(i-e)*Math.PI/180,n=(t-a)*Math.PI/180,o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371}(r,n,e.latitude,e.longitude):null}));r&&n&&(d=d.sort((e,a)=>(e.distance||0)-(a.distance||0)));let y="delivery-districts",k=(0,u.lJ)(y);k||(k=(await l.default.deliveryPoint.findMany({where:{isActive:!0},select:{district:!0},distinct:["district"]})).map(e=>e.district).sort(),(0,u.K7)(y,k,600));let m={points:d,districts:k,total:d.length};if(!r&&!n){let e=`delivery-points-${i}-${t||"all"}`;(0,u.K7)(e,m,600)}return s.NextResponse.json(m)}catch(e){return console.error("Teslim noktaları getirme hatası:",e),s.NextResponse.json({error:"Teslim noktaları getirilemedi"},{status:500})}}let k=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/delivery-points/route",pathname:"/api/delivery-points",filename:"route",bundlePath:"app/api/delivery-points/route"},resolvedPagePath:"/home/ubuntu/takas-a-kodlar/nextjs_space/app/api/delivery-points/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:p,serverHooks:g}=k,b="/api/delivery-points/route";function h(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},69767:(e,a,i)=>{i.d(a,{K7:()=>n,lJ:()=>r});let t=new Map;function r(e){let a=t.get(e);return a?Date.now()>a.expiry?(t.delete(e),null):a.data:null}function n(e,a,i=60){if(t.set(e,{data:a,expiry:Date.now()+1e3*i}),t.size>500){let e=t.keys().next().value;e&&t.delete(e)}}},83178:(e,a,i)=>{i.r(a),i.d(a,{default:()=>l});var t=i(53524);let r=globalThis,n="phase-production-build"===process.env.NEXT_PHASE||!0,o=r.prisma??(()=>{let e=new t.PrismaClient({log:["error"],datasources:{db:{url:function(){let e=process.env.DATABASE_URL||"";if(e.includes("connection_limit")||e.includes("pool_timeout"))return e;let a=e.includes("?")?"&":"?";return`${e}${a}connection_limit=${n?1:10}&pool_timeout=${n?60:20}&connect_timeout=10&socket_timeout=20&pgbouncer=true&statement_cache_size=0`}()}}});return e.$use(async(a,i)=>{let t=0;for(;t<=5;)try{let e=await i(a);return r.lastConnectTime=Date.now(),e}catch(i){let a=i instanceof Error?i.message:String(i);if((a.includes("idle-session timeout")||a.includes("terminating connection")||a.includes("ECONNRESET")||a.includes("Connection refused")||a.includes("connection closed")||a.includes("socket")||a.includes("ETIMEDOUT")||a.includes("connection timed out")||a.includes("prepared statement"))&&t<5){if(t++,console.log(`[Prisma] Connection error, retry ${t}/5: ${a.substring(0,100)}`),t>=2)try{await e.$disconnect(),await e.$connect(),console.log("[Prisma] Reconnected successfully")}catch{}await new Promise(e=>setTimeout(e,100*Math.pow(2,t-1)));continue}throw i}}),e})();r.prisma=o,"undefined"!=typeof process&&process.on("beforeExit",async()=>{await o.$disconnect()});let s=null;"undefined"==typeof process||n||!s&&(n||(s=setInterval(async()=>{try{await o.$queryRaw`SELECT 1`}catch(e){console.warn("[Prisma KeepAlive] Bağlantı hatası, yeniden bağlanılıyor:",e.message?.substring(0,80));try{await o.$connect(),console.log("[Prisma KeepAlive] Yeniden bağlantı başarılı")}catch(e){console.error("[Prisma KeepAlive] Yeniden bağlantı başarısız!")}}},12e4)).unref());let l=o},23522:(e,a,i)=>{i.d(a,{Jv:()=>l,Mu:()=>s,ij:()=>o,kQ:()=>c});let t={en:{"yillik kullanilmis":"years used","yil kullanilmis":"year used","inc ekran":"inch screen",beden:"size",numara:"size",adet:"pieces",parca:"pieces",renk:"color",siyah:"black",beyaz:"white",mavi:"blue",kirmizi:"red",yesil:"green",kahverengi:"brown",gri:"gray",bej:"beige",lacivert:"navy blue",pembe:"pink",Sifir:"Brand New",Sıfır:"Brand New","Sifir Gibi":"Like New","Sıfır Gibi":"Like New",İyi:"Good",Iyi:"Good",Orta:"Fair",Elektronik:"Electronics",Giyim:"Clothing","Ev & Yasam":"Home & Living","Ev & Yaşam":"Home & Living","Spor & Outdoor":"Sports & Outdoor","Kitap & Hobi":"Books & Hobbies","Cocuk & Bebek":"Kids & Baby","\xc7ocuk & Bebek":"Kids & Baby",Oyuncak:"Toys",Mutfak:"Kitchen",Bahce:"Garden",Bahçe:"Garden","Taki & Aksesuar":"Jewelry & Accessories","Takı & Aksesuar":"Jewelry & Accessories","Beyaz Esya":"White Goods","Beyaz Eşya":"White Goods",Diger:"Other",Diğer:"Other","Bebek Arabasi":"Baby Stroller","Bebek Arabas\xfd":"Baby Stroller",Puset:"Stroller",Karyola:"Crib",Yatak:"Mattress","Mama Sandalyesi":"High Chair","Kiyafet Seti":"Clothing Set","Banyo Seti":"Bath Set","Oyun Hali":"Play Mat",Besik:"Cradle",Yorgan:"Blanket","Tasima Kanguru":"Baby Carrier","Oto Koltugu":"Car Seat","Aktivite Jimnastik":"Activity Gym","Emzirme Minderi":"Nursing Pillow","Bez Cantasi":"Diaper Bag","Biberon Seti":"Bottle Set","Park Yatagi":"Travel Crib",Kulaklik:"Headphones",Telefon:"Phone",Tablet:"Tablet",Bilgisayar:"Computer",Laptop:"Laptop",Monitör:"Monitor",Monitor:"Monitor",Televizyon:"Television",TV:"TV",Ceket:"Jacket",Elbise:"Dress",Pantolon:"Pants",Gomlek:"Shirt",Gömlek:"Shirt",Ayakkabi:"Shoes",Ayakkabý:"Shoes",Canta:"Bag",Çanta:"Bag",Saat:"Watch",Kolye:"Necklace",Yuzuk:"Ring",Yüzük:"Ring",Kupe:"Earrings",Küpe:"Earrings",Bileklik:"Bracelet",Kitap:"Book",Roman:"Novel",Oyun:"Game",Bisiklet:"Bicycle","Spor Aleti":"Sports Equipment","Yoga Mati":"Yoga Mat",Dambil:"Dumbbell",Cadir:"Tent",Çadır:"Tent","Uyku Tulumu":"Sleeping Bag",Koltuk:"Sofa",Masa:"Table",Sandalye:"Chair",Dolap:"Cabinet",Raf:"Shelf",Lamba:"Lamp",Hali:"Carpet",Halý:"Carpet",Perde:"Curtain",Ayna:"Mirror",Buzdolabi:"Refrigerator","Camasir Makinesi":"Washing Machine","Bulasik Makinesi":"Dishwasher",Mikrodalga:"Microwave",Firin:"Oven",Fýrýn:"Oven","Tost Makinesi":"Toaster","Kahve Makinesi":"Coffee Maker","Su Isitici":"Electric Kettle",Blender:"Blender",Lego:"Lego","Oyuncak Araba":"Toy Car",Bebek:"Baby Doll",Puzzle:"Puzzle",Kadin:"Women's",Kadýn:"Women's",Erkek:"Men's",Cocuk:"Children's",Çocuk:"Children's",Unisex:"Unisex","Travel sistem":"Travel system",Hafif:"Lightweight",katlanir:"foldable",sallanir:"rocking","yukseklik ayarli":"height adjustable","yikaniir kilif":"washable cover","cok gozlu":"multi-pocket","Aktif gurultu engelleyici":"Active noise cancelling","gercek deri":"genuine leather",pamuklu:"cotton",organik:"organic",muzikli:"with music",ay:"months",yas:"years",yaş:"years"},es:{"yillik kullanilmis":"a\xf1os de uso","inc ekran":"pulgadas de pantalla",beden:"talla",numara:"n\xfamero",adet:"piezas",parca:"piezas",renk:"color",siyah:"negro",beyaz:"blanco",mavi:"azul",kirmizi:"rojo",Sifir:"Nuevo","Sifir Gibi":"Como Nuevo",İyi:"Bueno",Orta:"Regular",Elektronik:"Electr\xf3nica",Giyim:"Ropa","Ev & Yasam":"Hogar y Vida","Ev & Yaşam":"Hogar y Vida","Spor & Outdoor":"Deportes y Exterior","Kitap & Hobi":"Libros y Hobbies","Cocuk & Bebek":"Ni\xf1os y Beb\xe9s","\xc7ocuk & Bebek":"Ni\xf1os y Beb\xe9s",Oyuncak:"Juguetes",Mutfak:"Cocina",Bahce:"Jard\xedn",Bahçe:"Jard\xedn","Taki & Aksesuar":"Joyas y Accesorios","Takı & Aksesuar":"Joyas y Accesorios","Beyaz Esya":"Electrodom\xe9sticos","Beyaz Eşya":"Electrodom\xe9sticos",Diger:"Otros",Diğer:"Otros","Bebek Arabasi":"Cochecito de Beb\xe9",Puset:"Carrito",Karyola:"Cuna",Yatak:"Colch\xf3n","Mama Sandalyesi":"Trona","Kiyafet Seti":"Conjunto de Ropa",Kulaklik:"Auriculares",Telefon:"Tel\xe9fono",Ceket:"Chaqueta",Elbise:"Vestido",Kadin:"Mujer",Erkek:"Hombre",Cocuk:"Ni\xf1os",ay:"meses",yas:"a\xf1os"},ca:{"yillik kullanilmis":"anys d'\xfas","inc ekran":"polzades de pantalla",beden:"talla",numara:"n\xfamero",adet:"peces",parca:"peces",renk:"color",siyah:"negre",beyaz:"blanc",mavi:"blau",kirmizi:"vermell",Sifir:"Nou","Sifir Gibi":"Com Nou",İyi:"Bo",Orta:"Regular",Elektronik:"Electr\xf2nica",Giyim:"Roba","Ev & Yasam":"Llar i Vida","Ev & Yaşam":"Llar i Vida","Spor & Outdoor":"Esports i Exterior","Kitap & Hobi":"Llibres i Hobbies","Cocuk & Bebek":"Nens i Nadons","\xc7ocuk & Bebek":"Nens i Nadons",Oyuncak:"Joguines",Mutfak:"Cuina",Bahce:"Jard\xed",Bahçe:"Jard\xed","Taki & Aksesuar":"Joies i Accessoris","Takı & Aksesuar":"Joies i Accessoris","Beyaz Esya":"Electrodom\xe8stics","Beyaz Eşya":"Electrodom\xe8stics",Diger:"Altres",Diğer:"Altres","Bebek Arabasi":"Cotxet de Nad\xf3",Puset:"Cotxet",Karyola:"Bressol",Yatak:"Matal\xe0s","Mama Sandalyesi":"Trona","Kiyafet Seti":"Conjunt de Roba",Kulaklik:"Auriculars",Telefon:"Tel\xe8fon",Ceket:"Jaqueta",Elbise:"Vestit",Kadin:"Dona",Erkek:"Home",Cocuk:"Nens",ay:"mesos",yas:"anys"}},r={new:{tr:"Sıfır",en:"Brand New",es:"Nuevo",ca:"Nou"},likeNew:{tr:"Sıfır Gibi",en:"Like New",es:"Como Nuevo",ca:"Com Nou"},good:{tr:"İyi",en:"Good",es:"Bueno",ca:"Bo"},fair:{tr:"Orta",en:"Fair",es:"Regular",ca:"Regular"}};function n(e,a){if(!e||"tr"===a)return e;let i=t[a];if(!i)return e;let r=e;for(let e of Object.keys(i).sort((e,a)=>a.length-e.length)){let a=RegExp(e,"gi");r=r.replace(a,i[e])}return r}function o(e,a){let i=e.title,t=e.description;"en"===a&&e.titleEn?i=e.titleEn:"es"===a&&e.titleEs?i=e.titleEs:"ca"===a&&e.titleCa?i=e.titleCa:"tr"!==a&&(i=n(e.title,a)),"en"===a&&e.descriptionEn?t=e.descriptionEn:"es"===a&&e.descriptionEs?t=e.descriptionEs:"ca"===a&&e.descriptionCa?t=e.descriptionCa:"tr"!==a&&(t=n(e.description,a));let o=e.condition?r[e.condition]?.[a]||e.condition:"",s=e.category?.name;return e.category&&("en"===a&&e.category.nameEn?s=e.category.nameEn:"es"===a&&e.category.nameEs?s=e.category.nameEs:"ca"===a&&e.category.nameCa&&(s=e.category.nameCa)),{...e,translatedTitle:i,translatedDescription:t,translatedCondition:o,translatedCategory:s}}function s(e,a){return e.map(e=>o(e,a))}function l(e,a){if("en"===a&&e.nameEn)return e.nameEn;if("es"===a&&e.nameEs)return e.nameEs;if("ca"===a&&e.nameCa)return e.nameCa;if("tr"!==a&&t[a]){let i=t[a];if(i[e.name])return i[e.name];let r=e.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(i[r])return i[r]}return e.name}function c(e,a){let i=e.name,t=e.address;return"en"===a?(i=e.nameEn||e.name,t=e.addressEn||e.address):"es"===a?(i=e.nameEs||e.name,t=e.addressEs||e.address):"ca"===a&&(i=e.nameCa||e.name,t=e.addressCa||e.address),{translatedName:i,translatedAddress:t}}}};var a=require("../../../webpack-runtime.js");a.C(e);var i=e=>a(a.s=e),t=a.X(0,[8412,7609],()=>i(40825));module.exports=t})();