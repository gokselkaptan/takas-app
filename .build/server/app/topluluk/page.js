(()=>{var e={};e.id=2044,e.ids=[2044],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30739:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d}),t(2808),t(32314),t(9126),t(84131),t(24450);var s=t(36576),r=t(72007),i=t(21818),l=t.n(i),n=t(88897),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(a,o);let d=["",{children:["topluluk",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2808)),"/home/ubuntu/takas-a-kodlar/nextjs_space/app/topluluk/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,32314)),"/home/ubuntu/takas-a-kodlar/nextjs_space/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,9126)),"/home/ubuntu/takas-a-kodlar/nextjs_space/app/error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,84131)),"/home/ubuntu/takas-a-kodlar/nextjs_space/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,24450)),"/home/ubuntu/takas-a-kodlar/nextjs_space/app/not-found.tsx"]}],c=["/home/ubuntu/takas-a-kodlar/nextjs_space/app/topluluk/page.tsx"],m="/topluluk/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/topluluk/page",pathname:"/topluluk",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},51485:(e,a,t)=>{Promise.resolve().then(t.bind(t,31654))},31654:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>E});var s=t(62901),r=t(24383),i=t(84700),l=t(84374),n=t(13943),o=t(80412),d=t(75115),c=t(62392),m=t(32907),u=t(31198),x=t(83545),p=t(49356),h=t(79046),g=t(23422),y=t(66843),f=t(30808),j=t(43896),b=t(21391),v=t(62451),k=t(16501),w=t(97107),N=t(10333),z=t(26482),D=t(7259),_=t(27878),$=t(250),C=t(54936);let Z=(0,t(71945).Z)("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function S({userId:e,initialFollowing:a=!1,onFollowChange:t,size:n="default",variant:o="default"}){let{data:d}=(0,i.useSession)(),c=d?.user?.id,m=(0,l.useRouter)(),{language:u}=(0,C.Z)(),[x,h]=(0,r.useState)(a),[g,y]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!0),b=async()=>{if(!d){m.push("/giris");return}y(!0);try{x?(await fetch(`/api/follow?userId=${e}`,{method:"DELETE"})).ok&&(h(!1),t?.(!1)):(await fetch("/api/follow",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})})).ok&&(h(!0),t?.(!0))}catch(e){console.error("Failed to follow/unfollow:",e)}finally{y(!1)}};return c===e?null:f?s.jsx(_.z,{variant:"outline",size:n,disabled:!0,children:s.jsx(N.Z,{className:"w-4 h-4 animate-spin"})}):s.jsx(_.z,{onClick:b,disabled:g,variant:x?"outline":o,size:n,className:`gap-1.5 ${x?"text-gray-600 hover:text-red-500 hover:border-red-300":"bg-frozen-500 hover:bg-frozen-600 text-white"}`,children:g?s.jsx(N.Z,{className:"w-4 h-4 animate-spin"}):x?(0,s.jsxs)(s.Fragment,{children:[s.jsx(Z,{className:"w-4 h-4"}),s.jsx("span",{children:"en"===u?"Following":"Takip Ediliyor"})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(p.Z,{className:"w-4 h-4"}),s.jsx("span",{children:"en"===u?"Follow":"Takip Et"})]})})}var T=t(40140),P=t(43921);function E(){let{data:e}=(0,i.useSession)(),a=(0,l.useRouter)(),{language:t}=(0,C.Z)(),[Z,E]=(0,r.useState)([]),[F,M]=(0,r.useState)(!0),[I,A]=(0,r.useState)("public"),[q,L]=(0,r.useState)(1),[O,R]=(0,r.useState)(!0),[K,U]=(0,r.useState)(!1),[G,H]=(0,r.useState)(null),[J,V]=(0,r.useState)({}),[X,B]=(0,r.useState)(""),[W,Y]=(0,r.useState)(null),[Q,ee]=(0,r.useState)(!1),ea=async(e=!1)=>{e?(M(!0),L(1)):U(!0);try{let a=e?1:q,{data:t,error:s}=await (0,T.wz)(`/api/activity/feed?type=${I}&page=${a}&limit=20`);if(s){console.error("Feed error:",s);return}t&&(e?E(t.activities||[]):E(e=>[...e,...t.activities||[]]),R(a<(t.pagination?.totalPages||1)),e||L(e=>e+1))}catch(e){console.error("Activity fetch error:",e)}finally{M(!1),U(!1)}},et=async(t,s)=>{if(!e){a.push("/giris");return}try{if(s){let{error:e}=await (0,T.wz)(`/api/activity/like?activityId=${t}`,{method:"DELETE"});if(e){P.Am.error(e);return}}else{let{error:e}=await (0,T.wz)("/api/activity/like",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({activityId:t})});if(e){P.Am.error(e);return}}E(e=>e.map(e=>e.id===t?{...e,isLiked:!s,likeCount:e.likeCount+(s?-1:1)}:e))}catch(e){console.error("Like error:",e)}},es=async e=>{if(!J[e]){Y(e);try{let{data:a,error:t}=await (0,T.wz)(`/api/activity/comment?activityId=${e}`);if(t){console.error(t);return}a&&V(t=>({...t,[e]:a}))}catch(e){console.error("Failed to load comments:",e)}finally{Y(null)}}},er=async a=>{if(e&&X.trim()){ee(!0);try{let{data:e,error:t}=await (0,T.wz)("/api/activity/comment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({activityId:a,content:X})});if(t){P.Am.error(t);return}e&&(V(t=>({...t,[a]:[...t[a]||[],e]})),E(e=>e.map(e=>e.id===a?{...e,commentCount:e.commentCount+1}:e)),B(""))}catch(e){console.error("Comment error:",e)}finally{ee(!1)}}},ei=e=>{switch(e){case"swap_completed":return s.jsx(m.Z,{className:"w-4 h-4 text-green-500"});case"badge_earned":return s.jsx(u.Z,{className:"w-4 h-4 text-yellow-500"});case"product_listed":return s.jsx(x.Z,{className:"w-4 h-4 text-blue-500"});case"followed_user":return s.jsx(p.Z,{className:"w-4 h-4 text-purple-500"});case"review_given":return s.jsx(h.Z,{className:"w-4 h-4 text-orange-500"});default:return s.jsx(g.Z,{className:"w-4 h-4 text-gray-500"})}},el=e=>{let a=e.user?.name||e.user?.nickname||e.userName||"Kullanıcı";switch(e.type){case"swap_completed":return"en"===t?`${a} completed a swap`:`${a} bir takas tamamladı`;case"badge_earned":return"en"===t?`${a} earned a badge`:`${a} yeni bir rozet kazandı`;case"product_listed":return"en"===t?`${a} listed a new product`:`${a} yeni bir \xfcr\xfcn listeledi`;case"followed_user":return"en"===t?`${a} started following ${e.targetUserName}`:`${a}, ${e.targetUserName} kullanıcısını takip etmeye başladı`;case"review_given":return"en"===t?`${a} gave a review`:`${a} bir değerlendirme yaptı`;default:return"en"===t?`${a} shared an activity`:`${a} bir aktivite paylaştı`}},en=e=>{let a=new Date(e),s=new Date().getTime()-a.getTime(),r=Math.floor(s/6e4),i=Math.floor(s/36e5),l=Math.floor(s/864e5);return r<1?"en"===t?"Just now":"Az \xf6nce":r<60?`${r}${"en"===t?"m":"dk"}`:i<24?`${i}${"en"===t?"h":"sa"}`:l<7?`${l}${"en"===t?"d":"g"}`:a.toLocaleDateString("tr-TR")};return s.jsx("main",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white pt-20 pb-24",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(y.Z,{className:"w-6 h-6 text-frozen-500"}),"en"===t?"Community Feed":"Topluluk"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"en"===t?"See what the community is up to":"Toplulukta neler oluyor g\xf6r"})]}),(0,s.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-2xl border dark:border-gray-700",children:[(0,s.jsxs)("h3",{className:"font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:["\uD83C\uDF10 ","en"===t?"Our Social Communities":"Sosyal Medya Topluluklarımız"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[{id:"instagram",name:"Instagram",icon:"\uD83D\uDCF8",url:"https://instagram.com/takasa"},{id:"twitter",name:"X (Twitter)",icon:"\uD83D\uDC26",url:"https://x.com/takasa"},{id:"tiktok",name:"TikTok",icon:"\uD83C\uDFB5",url:"https://tiktok.com/@takasa"},{id:"facebook",name:"Facebook",icon:"\uD83D\uDCD8",url:"https://facebook.com/takasa"}].map(e=>(0,s.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-white dark:bg-gray-800 rounded-xl hover:shadow-md transition-all text-sm font-medium text-gray-700 dark:text-gray-200",children:[s.jsx("span",{className:"text-xl",children:e.icon}),s.jsx("span",{children:e.name})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex gap-2 mb-4 sticky top-16 z-10 bg-white/80 backdrop-blur-sm py-2 -mx-4 px-4",children:[(0,s.jsxs)(_.z,{variant:"public"===I?"default":"outline",size:"sm",onClick:()=>A("public"),className:"public"===I?"bg-frozen-500":"",children:[s.jsx(f.Z,{className:"w-4 h-4 mr-1"}),"en"===t?"Explore":"Keşfet"]}),(0,s.jsxs)(_.z,{variant:"following"===I?"default":"outline",size:"sm",onClick:()=>A("following"),disabled:!e,className:"following"===I?"bg-frozen-500":"",children:[s.jsx(y.Z,{className:"w-4 h-4 mr-1"}),"en"===t?"Following":"Takip"]}),s.jsx(_.z,{variant:"ghost",size:"sm",onClick:()=>ea(!0),className:"ml-auto",children:s.jsx(j.Z,{className:"w-4 h-4"})})]}),F?s.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>s.jsx("div",{className:"bg-white rounded-xl p-4 animate-pulse",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})},e))}):0===Z.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(y.Z,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-600",children:"following"===I?"en"===t?"No activities from people you follow":"Takip ettiklerinizden aktivite yok":"en"===t?"No activities yet":"Hen\xfcz aktivite yok"}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"en"===t?"Start swapping to see activities here!":"Takas yapmaya başlayın, aktiviteler burada g\xf6r\xfcns\xfcn!"})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx(n.M,{children:Z.map((a,r)=>(0,s.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*r},className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[s.jsx(c.default,{href:`/profil?userId=${a.userId}`,children:s.jsx("div",{className:"relative w-10 h-10 rounded-full overflow-hidden bg-gray-200 flex-shrink-0",children:a.user?.image?s.jsx(d.default,{src:a.user.image,alt:a.user?.name||"",fill:!0,className:"object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-frozen-100 text-frozen-600 font-bold",children:(a.user?.name||a.userName||"K")[0].toUpperCase()})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[ei(a.type),s.jsx("p",{className:"text-sm text-gray-800",children:el(a)})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:[s.jsx(b.Z,{className:"w-3 h-3 inline mr-1"}),en(a.createdAt),a.city&&` • ${a.city}`]})]}),a.userId!==e?.user?.id&&s.jsx(S,{userId:a.userId,size:"sm"})]}),"badge_earned"===a.type&&a.badgeData&&s.jsx("div",{className:"mt-3 p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-3xl",children:a.badgeData.badgeIcon}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold text-gray-800",children:a.badgeData.badgeName}),a.badgeData.valorReward>0&&(0,s.jsxs)("p",{className:"text-xs text-green-600",children:["+",a.badgeData.valorReward," Valor"]})]})]})}),a.productData&&s.jsx(c.default,{href:`/urun/${a.productData.id}`,children:(0,s.jsxs)("div",{className:"mt-3 flex gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-200 flex-shrink-0",children:a.productData.images?.[0]&&s.jsx(d.default,{src:a.productData.images[0],alt:a.productData.title,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium text-gray-800 text-sm line-clamp-1",children:a.productData.title}),(0,s.jsxs)("p",{className:"text-frozen-600 font-bold text-sm",children:[a.productData.valorPrice," Valor"]})]})]})})]}),(0,s.jsxs)("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-4",children:[(0,s.jsxs)("button",{onClick:()=>et(a.id,a.isLiked),className:`flex items-center gap-1.5 text-sm transition-colors ${a.isLiked?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[s.jsx(v.Z,{className:`w-4 h-4 ${a.isLiked?"fill-current":""}`}),s.jsx("span",{children:a.likeCount})]}),(0,s.jsxs)("button",{onClick:()=>{G===a.id?H(null):(H(a.id),es(a.id))},className:"flex items-center gap-1.5 text-sm text-gray-500 hover:text-frozen-500 transition-colors",children:[s.jsx(k.Z,{className:"w-4 h-4"}),s.jsx("span",{children:a.commentCount})]}),s.jsx("button",{className:"flex items-center gap-1.5 text-sm text-gray-500 hover:text-green-500 transition-colors ml-auto",children:s.jsx(w.Z,{className:"w-4 h-4"})})]}),s.jsx(n.M,{children:G===a.id&&(0,s.jsxs)(o.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-gray-100",children:[s.jsx("div",{className:"p-4 space-y-3 max-h-60 overflow-y-auto",children:W===a.id?s.jsx("div",{className:"flex justify-center py-2",children:s.jsx(N.Z,{className:"w-5 h-5 animate-spin text-gray-400"})}):J[a.id]?.length===0?s.jsx("p",{className:"text-center text-sm text-gray-600 py-2",children:"en"===t?"No comments yet":"Hen\xfcz yorum yok"}):J[a.id]?.map(e=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"w-7 h-7 rounded-full overflow-hidden bg-gray-200 flex-shrink-0",children:e.user.image?s.jsx(d.default,{src:e.user.image,alt:e.user.name||"",width:28,height:28,className:"object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-frozen-100 text-frozen-600 text-xs font-bold",children:(e.user.name||"K")[0].toUpperCase()})}),s.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg px-3 py-2",children:[s.jsx("p",{className:"text-xs font-medium text-gray-700",children:e.user.nickname||e.user.name}),s.jsx("p",{className:"text-sm text-gray-600",children:e.content})]})]},e.id))}),e&&s.jsx("div",{className:"px-4 pb-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx($.I,{value:X,onChange:e=>B(e.target.value),placeholder:"en"===t?"Write a comment...":"Yorum yaz...",className:"text-sm",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),er(a.id))}}),s.jsx(_.z,{size:"sm",onClick:()=>er(a.id),disabled:!X.trim()||Q,className:"bg-frozen-500",children:Q?s.jsx(N.Z,{className:"w-4 h-4 animate-spin"}):s.jsx(z.Z,{className:"w-4 h-4"})})]})})]})})]},a.id))}),O&&s.jsx("div",{className:"flex justify-center py-4",children:(0,s.jsxs)(_.z,{variant:"outline",onClick:()=>ea(!1),disabled:K,children:[K?s.jsx(N.Z,{className:"w-4 h-4 animate-spin mr-2"}):s.jsx(D.Z,{className:"w-4 h-4 mr-2"}),"en"===t?"Load More":"Daha Fazla"]})})]})]})})}},32907:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(71945).Z)("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]])},30808:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(71945).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},2808:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let s=(0,t(88895).createProxy)(String.raw`/home/ubuntu/takas-a-kodlar/nextjs_space/app/topluluk/page.tsx#default`)}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8412,4674,3921,6866,858,4885],()=>t(30739));module.exports=s})();