"use strict";exports.id=8373,exports.ids=[8373],exports.modules={11826:(e,t,r)=>{r.d(t,{L:()=>l});var i=r(66291),a=r(64617),s=r(3390),n=r.n(s),o=r(83178),d=r(59521);let l={adapter:(0,a.N)(o.default),providers:[(0,i.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e,t){if(!e?.email||!e?.password)return null;let r=t?.headers?.["x-real-ip"],i=t?.headers?.["x-forwarded-for"],a=r?Array.isArray(r)?r[0]:r:i&&(Array.isArray(i)?i[0]:i).split(",").pop()?.trim()||"unknown",s=t?.headers?.["user-agent"]||"unknown";if(!(await (0,d.d5)(a,e.email)).allowed)throw await (0,d.Ky)(e.email,a,5,void 0),Error("ACCOUNT_LOCKED");let l=await o.default.user.findUnique({where:{email:e.email}});return l?await n().compare(e.password,l.password)?(await (0,d.LW)(a,l.id,l.email,s),await o.default.user.update({where:{id:l.id},data:{lastLoginAt:new Date}}),{id:l.id,email:l.email,name:l.name,role:l.role}):(await (0,d.Vm)(a,e.email,s,"Invalid password"),null):(await (0,d.Vm)(a,e.email,s,"User not found"),null)}})],session:{strategy:"jwt",maxAge:86400,updateAge:300},jwt:{maxAge:86400},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.role=t.role),e),session:async({session:e,token:t})=>(e?.user&&(e.user.id=t?.id,e.user.role=t?.role),e)},pages:{signIn:"/giris"},secret:process.env.NEXTAUTH_SECRET,cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0}}}}},68247:(e,t,r)=>{r.d(t,{AN:()=>u,F6:()=>o,Qi:()=>a,Sq:()=>d,kg:()=>i,nk:()=>l,u2:()=>c,uF:()=>p});let i=parseInt(process.env.DISPUTE_WINDOW_HOURS||"48"),a=(parseInt(process.env.LOCK_TIMEOUT_HOURS||"48"),parseInt(process.env.QR_CODE_VALIDITY_HOURS||"72"),parseInt(process.env.VERIFICATION_CODE_VALIDITY_HOURS||"24"),"false"!==process.env.AUTO_COMPLETE_LOW_RISK),s=(parseInt(process.env.AUTO_COMPLETE_DELAY_HOURS||"0"),parseFloat(process.env.PREMIUM_RATE_BASE||"0.015"),parseFloat(process.env.PREMIUM_RATE_MIN||"0.01"),parseFloat(process.env.PREMIUM_RATE_MAX||"0.03"),parseFloat(process.env.TARGET_RESERVE_RATIO_30D||"0.05"),parseFloat(process.env.POOL_REBALANCE_STEP||"0.0025"),{LOW_MAX:parseInt(process.env.RISK_LOW_MAX||"100"),MEDIUM_MAX:parseInt(process.env.RISK_MEDIUM_MAX||"500")}),n={Elektronik:1.5,Bilgisayar:1.5,Telefon:1.5,"Oyun Konsolu":1.3,Mücevher:2,Saat:1.5,Antika:2,Sanat:2,default:1},o={PENDING:"pending",ACCEPTED:"accepted",REJECTED:"rejected",IN_DELIVERY:"in_delivery",DELIVERED:"delivered",COMPLETED:"completed",CANCELLED:"cancelled",DISPUTED:"disputed",RESOLVED:"resolved"},d={pending:["accepted","rejected","cancelled"],accepted:["in_delivery","delivered","completed","cancelled","disputed"],rejected:[],in_delivery:["delivered","disputed"],delivered:["completed","disputed"],completed:[],cancelled:[],disputed:["resolved","completed","cancelled"],resolved:["completed","cancelled"]};function l(e,t){let r=e*(t?n[t]||n.default:1);return r<=s.LOW_MAX?"low":r<=s.MEDIUM_MAX?"medium":"high"}function u(e){let t=new Date(e);return t.setHours(t.getHours()+i),t}let c={completedSwap:2,positiveReview:1,negativeReview:-5,disputeLost:-10,cancelledByUser:-3,noShow:-15,fakeProduct:-25,reportedAbuse:-20,phoneVerification:5,identityVerification:5,accountAgePerMonth:0};function p(e,t){return Math.max(0,Math.min(100,e+t))}},30855:(e,t,r)=>{r.d(t,{DF:()=>u,Eg:()=>l,F1:()=>c,Jk:()=>d,P3:()=>o,_G:()=>p,hA:()=>n});var i=r(83178);r(68247);let a={unverified:.2,phoneVerified:.1,fullyVerified:.05,trustedUser:.02},s={LOW:50,MEDIUM:75,HIGH:90};function n(e){return e<30?{canSwap:!1,isSuspended:!0,requiresHigherDeposit:!0,depositMultiplier:2,maxActiveSwaps:0,limitedSwapsPerDay:0,requiresPhoneVerification:!0,cannotBoostProducts:!0,warningMessage:"\uD83D\uDEAB Hesabınız d\xfcş\xfck g\xfcven puanı nedeniyle askıya alınmıştır. Destek ile iletişime ge\xe7in.",message:"Hesabınız d\xfcş\xfck g\xfcven puanı nedeniyle askıya alındı. Destek ekibiyle iletişime ge\xe7in."}:e<s.LOW?{canSwap:!0,isSuspended:!1,requiresHigherDeposit:!0,depositMultiplier:2,maxActiveSwaps:1,limitedSwapsPerDay:2,requiresPhoneVerification:!0,cannotBoostProducts:!0,warningMessage:"\uD83D\uDD34 G\xfcven puanınız kritik seviyede. Takas haklarınız kısıtlanmıştır.",message:"D\xfcş\xfck g\xfcven puanı nedeniyle teminat artırıldı ve tek takas ile sınırlısınız."}:e<s.MEDIUM?{canSwap:!0,isSuspended:!1,requiresHigherDeposit:!0,depositMultiplier:1.5,maxActiveSwaps:3,limitedSwapsPerDay:5,requiresPhoneVerification:!0,cannotBoostProducts:!1,warningMessage:"⚠️ G\xfcven puanınız d\xfcş\xfck. Başarılı takaslar yaparak puanınızı y\xfckseltebilirsiniz."}:e<s.HIGH?{canSwap:!0,isSuspended:!1,requiresHigherDeposit:!1,depositMultiplier:1,maxActiveSwaps:5,limitedSwapsPerDay:99,requiresPhoneVerification:!1,cannotBoostProducts:!1,warningMessage:null}:{canSwap:!0,isSuspended:!1,requiresHigherDeposit:!1,depositMultiplier:.8,maxActiveSwaps:10,limitedSwapsPerDay:99,requiresPhoneVerification:!1,cannotBoostProducts:!1,warningMessage:null}}async function o(e){let t=await i.default.user.findUnique({where:{id:e},select:{isPhoneVerified:!0,isIdentityVerified:!0,trustScore:!0,_count:{select:{swapRequestsSent:{where:{status:"completed"}},swapRequestsReceived:{where:{status:"completed"}}}}}});if(!t)return{isPhoneVerified:!1,isIdentityVerified:!1,trustScore:0,completedSwaps:0,trustLevel:"unverified",depositRate:a.unverified};let r=t._count.swapRequestsSent+t._count.swapRequestsReceived,n="unverified",o=a.unverified;return r>=10&&t.trustScore>=s.HIGH?(n="trustedUser",o=a.trustedUser):t.isIdentityVerified?(n="fullyVerified",o=a.fullyVerified):t.isPhoneVerified&&(n="phoneVerified",o=a.phoneVerified),{isPhoneVerified:t.isPhoneVerified,isIdentityVerified:t.isIdentityVerified,trustScore:t.trustScore,completedSwaps:r,trustLevel:n,depositRate:o}}async function d(e,t,r,i){let[a,s]=await Promise.all([o(e),o(t)]),n=Math.max(5,Math.round(r*a.depositRate)),d=i?Math.max(5,Math.round(i*s.depositRate)):0;return{requesterDeposit:n,ownerDeposit:d,totalLocked:n+d,requesterTrustLevel:a.trustLevel,ownerTrustLevel:s.trustLevel}}async function l(e,t,r,a){let s=await i.default.user.findUnique({where:{id:e},select:{valorBalance:!0,lockedValor:!0}});if(!s)return{success:!1,error:"Kullanıcı bulunamadı"};let n=s.valorBalance-s.lockedValor;if(n<t)return{success:!1,error:`Yetersiz bakiye. Gerekli: ${t} Valor, Mevcut: ${n} Valor`};await i.default.user.update({where:{id:e},data:{lockedValor:{increment:t}}});let o="requester"===a?{requesterDeposit:t}:{ownerDeposit:t};return await i.default.swapRequest.update({where:{id:r},data:o}),{success:!0}}async function u(e){let t=await i.default.swapRequest.findUnique({where:{id:e},select:{requesterDeposit:!0,ownerDeposit:!0,offeredProductId:!0}});return!!t&&!!t.requesterDeposit&&(!t.offeredProductId||!!t.ownerDeposit)&&(await i.default.swapRequest.update({where:{id:e},data:{escrowStatus:"locked",depositsLocked:!0}}),!0)}async function c(e){let t=await i.default.swapRequest.findUnique({where:{id:e},select:{requesterId:!0,ownerId:!0,requesterDeposit:!0,ownerDeposit:!0,escrowStatus:!0}});t&&"locked"===t.escrowStatus&&(t.requesterDeposit&&await i.default.user.update({where:{id:t.requesterId},data:{lockedValor:{decrement:t.requesterDeposit}}}),t.ownerDeposit&&await i.default.user.update({where:{id:t.ownerId},data:{lockedValor:{decrement:t.ownerDeposit}}}),await i.default.swapRequest.update({where:{id:e},data:{escrowStatus:"released"}}))}function p(e){switch(e){case"trustedUser":return{label:"G\xfcvenilir \xdcye",color:"gold",icon:"\uD83C\uDFC6",description:"10+ başarılı takas, y\xfcksek g\xfcven puanı"};case"fullyVerified":return{label:"Kimlik Doğrulanmış",color:"green",icon:"✅",description:"Kimlik belgesi onaylanmış"};case"phoneVerified":return{label:"Telefon Doğrulanmış",color:"blue",icon:"\uD83D\uDCF1",description:"Telefon numarası doğrulanmış"};default:return{label:"Doğrulanmamış",color:"gray",icon:"⚠️",description:"Hen\xfcz doğrulama yapılmamış"}}}}};