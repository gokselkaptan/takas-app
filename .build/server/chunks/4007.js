"use strict";exports.id=4007,exports.ids=[4007],exports.modules={11826:(e,r,a)=>{a.d(r,{L:()=>u});var t=a(66291),i=a(64617),n=a(3390),s=a.n(n),o=a(83178),l=a(59521);let u={adapter:(0,i.N)(o.default),providers:[(0,t.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e,r){if(!e?.email||!e?.password)return null;let a=r?.headers?.["x-real-ip"],t=r?.headers?.["x-forwarded-for"],i=a?Array.isArray(a)?a[0]:a:t&&(Array.isArray(t)?t[0]:t).split(",").pop()?.trim()||"unknown",n=r?.headers?.["user-agent"]||"unknown";if(!(await (0,l.d5)(i,e.email)).allowed)throw await (0,l.Ky)(e.email,i,5,void 0),Error("ACCOUNT_LOCKED");let u=await o.default.user.findUnique({where:{email:e.email}});return u?await s().compare(e.password,u.password)?(await (0,l.LW)(i,u.id,u.email,n),await o.default.user.update({where:{id:u.id},data:{lastLoginAt:new Date}}),{id:u.id,email:u.email,name:u.name,role:u.role}):(await (0,l.Vm)(i,e.email,n,"Invalid password"),null):(await (0,l.Vm)(i,e.email,n,"User not found"),null)}})],session:{strategy:"jwt",maxAge:86400,updateAge:300},jwt:{maxAge:86400},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id,e.role=r.role),e),session:async({session:e,token:r})=>(e?.user&&(e.user.id=r?.id,e.user.role=r?.role),e)},pages:{signIn:"/giris"},secret:process.env.NEXTAUTH_SECRET,cookies:{sessionToken:{name:"__Secure-next-auth.session-token",options:{httpOnly:!0,sameSite:"lax",path:"/",secure:!0}}}}},58034:(e,r,a)=>{a.d(r,{Jd:()=>o,b0:()=>s,ub:()=>n});var t=a(83178);let i=[{slug:"ilk_takas",name:"İlk Takas",nameEn:"First Swap",description:"İlk takasını başarıyla tamamladın!",descriptionEn:"You completed your first swap!",icon:"\uD83C\uDF89",category:"swap",tier:"bronze",valorReward:3,requirement:JSON.stringify({type:"swap_count",value:1}),sortOrder:1},{slug:"takas_ustasi_5",name:"Takas Ustası",nameEn:"Swap Master",description:"5 takası başarıyla tamamladın!",descriptionEn:"You completed 5 swaps!",icon:"⭐",category:"swap",tier:"silver",valorReward:8,requirement:JSON.stringify({type:"swap_count",value:5}),sortOrder:2},{slug:"takas_gurusu_20",name:"Takas Gurusu",nameEn:"Swap Guru",description:"20 takası başarıyla tamamladın! Ger\xe7ek bir takas uzmanısın.",descriptionEn:"You completed 20 swaps! You are a true swap expert.",icon:"\uD83C\uDFC6",category:"swap",tier:"gold",valorReward:20,requirement:JSON.stringify({type:"swap_count",value:20}),sortOrder:3},{slug:"takas_efsanesi_50",name:"Takas Efsanesi",nameEn:"Swap Legend",description:"50 takas! Topluluğun en aktif \xfcyelerinden birisin.",descriptionEn:"50 swaps! You are one of the most active members.",icon:"\uD83D\uDC51",category:"swap",tier:"platinum",valorReward:50,requirement:JSON.stringify({type:"swap_count",value:50}),sortOrder:4},{slug:"guvenilir_uye",name:"G\xfcvenilir \xdcye",nameEn:"Trusted Member",description:"G\xfcven puanın 90'ın \xfczerinde!",descriptionEn:"Your trust score is above 90!",icon:"✅",category:"trust",tier:"silver",valorReward:10,requirement:JSON.stringify({type:"trust_score",value:90}),sortOrder:5},{slug:"kimlik_dogrulandi",name:"Kimlik Doğrulandı",nameEn:"Identity Verified",description:"Kimliğini doğruladın. Hesabın daha g\xfcvenli!",descriptionEn:"You verified your identity. Your account is more secure!",icon:"\uD83D\uDEE1️",category:"trust",tier:"silver",valorReward:15,requirement:JSON.stringify({type:"identity_verified",value:!0}),sortOrder:6},{slug:"kusursuz_satici",name:"Kusursuz Satıcı",nameEn:"Perfect Seller",description:"10+ takas ve ortalama 4.8+ puan aldın!",descriptionEn:"10+ swaps with 4.8+ average rating!",icon:"\uD83D\uDC8E",category:"trust",tier:"gold",valorReward:30,requirement:JSON.stringify({type:"perfect_rating",minSwaps:10,minRating:4.8}),sortOrder:7},{slug:"hosgeldin",name:"Hoşgeldin",nameEn:"Welcome",description:"TAKAS-A topluluğuna hoş geldin!",descriptionEn:"Welcome to the TAKAS-A community!",icon:"\uD83D\uDC4B",category:"community",tier:"bronze",valorReward:2,requirement:JSON.stringify({type:"account_created",value:!0}),sortOrder:8},{slug:"ilk_urun",name:"İlk \xdcr\xfcn",nameEn:"First Product",description:"İlk \xfcr\xfcn\xfcn\xfc listelidin!",descriptionEn:"You listed your first product!",icon:"\uD83D\uDCE6",category:"community",tier:"bronze",valorReward:3,requirement:JSON.stringify({type:"product_count",value:1}),sortOrder:9},{slug:"urun_koleksiyoneri_10",name:"\xdcr\xfcn Koleksiyoncusu",nameEn:"Product Collector",description:"10 \xfcr\xfcn listelidin! Harika bir koleksiyon.",descriptionEn:"You listed 10 products! Great collection.",icon:"\uD83D\uDDC3️",category:"community",tier:"silver",valorReward:12,requirement:JSON.stringify({type:"product_count",value:10}),sortOrder:10},{slug:"arkadasini_getir",name:"Arkadaşını Getir",nameEn:"Bring a Friend",description:"İlk referansını yaptın!",descriptionEn:"You made your first referral!",icon:"\uD83E\uDD1D",category:"community",tier:"bronze",valorReward:5,requirement:JSON.stringify({type:"referral_count",value:1}),sortOrder:11},{slug:"sosyal_kelebek",name:"Sosyal Kelebek",nameEn:"Social Butterfly",description:"10 kişiyi takip ettin!",descriptionEn:"You followed 10 people!",icon:"\uD83E\uDD8B",category:"community",tier:"bronze",valorReward:5,requirement:JSON.stringify({type:"following_count",value:10}),sortOrder:12},{slug:"populer_profil",name:"Pop\xfcler Profil",nameEn:"Popular Profile",description:"25 takip\xe7iye ulaştın!",descriptionEn:"You reached 25 followers!",icon:"\uD83C\uDF1F",category:"community",tier:"silver",valorReward:10,requirement:JSON.stringify({type:"follower_count",value:25}),sortOrder:13},{slug:"topluluk_lideri",name:"Topluluk Lideri",nameEn:"Community Leader",description:"100 takip\xe7iye ulaştın! Ger\xe7ek bir influencer'sın.",descriptionEn:"You reached 100 followers! You are a true influencer.",icon:"\uD83C\uDFAF",category:"community",tier:"gold",valorReward:30,requirement:JSON.stringify({type:"follower_count",value:100}),sortOrder:14},{slug:"degerlendirme_ustasi",name:"Değerlendirme Ustası",nameEn:"Review Master",description:"10 değerlendirme yaptın!",descriptionEn:"You wrote 10 reviews!",icon:"\uD83D\uDCDD",category:"achievement",tier:"silver",valorReward:8,requirement:JSON.stringify({type:"review_count",value:10}),sortOrder:15},{slug:"erken_kus",name:"Erken Kuş",nameEn:"Early Bird",description:"Platformun ilk 1000 \xfcyesinden birisin!",descriptionEn:"You are one of the first 1000 members!",icon:"\uD83D\uDC26",category:"achievement",tier:"gold",valorReward:15,requirement:JSON.stringify({type:"early_adopter",value:1e3}),isSecret:!0,sortOrder:16},{slug:"hafta_sonu_savaş\xe7ısı",name:"Hafta Sonu Savaş\xe7ısı",nameEn:"Weekend Warrior",description:"Hafta sonunda 3 takas tamamladın!",descriptionEn:"You completed 3 swaps on a weekend!",icon:"⚔️",category:"achievement",tier:"bronze",valorReward:5,requirement:JSON.stringify({type:"weekend_swaps",value:3}),isSecret:!0,sortOrder:17},{slug:"cok_kategorili",name:"\xc7ok Kategorili",nameEn:"Multi-Category",description:"5 farklı kategoride \xfcr\xfcn listelidin!",descriptionEn:"You listed products in 5 different categories!",icon:"\uD83C\uDFA8",category:"achievement",tier:"silver",valorReward:10,requirement:JSON.stringify({type:"category_diversity",value:5}),sortOrder:18},{slug:"hizli_yanit",name:"Hızlı Yanıt",nameEn:"Quick Response",description:"Mesajlara ortalama 1 saat i\xe7inde yanıt veriyorsun!",descriptionEn:"You respond to messages within 1 hour on average!",icon:"⚡",category:"achievement",tier:"silver",valorReward:8,requirement:JSON.stringify({type:"response_time",value:60}),sortOrder:19},{slug:"valor_zengini",name:"Valor Zengini",nameEn:"Valor Rich",description:"1000+ Valor topladın!",descriptionEn:"You collected 1000+ Valor!",icon:"\uD83D\uDCB0",category:"achievement",tier:"gold",valorReward:20,requirement:JSON.stringify({type:"total_valor_earned",value:1e3}),sortOrder:20}];async function n(e){let r=[],a={};try{let i=await t.default.user.findUnique({where:{id:e},include:{products:{where:{status:"active"}},swapRequestsSent:{where:{status:"completed"}},swapRequestsReceived:{where:{status:"completed"}},reviewsGiven:!0,referrals:!0,badges:{include:{badge:!0}},followers:!0,following:!0}});if(!i)return{awarded:r,progress:a};let n=i.badges.map(e=>e.badge.slug);for(let s of(await t.default.badge.findMany({where:{isActive:!0}}))){if(n.includes(s.slug))continue;let o=JSON.parse(s.requirement),l=!1,u=0;switch(o.type){case"swap_count":let d=i.swapRequestsSent.length+i.swapRequestsReceived.length;u=Math.min(100,d/o.value*100),l=d>=o.value;break;case"trust_score":u=Math.min(100,i.trustScore/o.value*100),l=i.trustScore>=o.value;break;case"identity_verified":u=i.isIdentityVerified?100:0,l=i.isIdentityVerified;break;case"account_created":u=100,l=!0;break;case"product_count":u=Math.min(100,i.products.length/o.value*100),l=i.products.length>=o.value;break;case"referral_count":u=Math.min(100,i.totalReferrals/o.value*100),l=i.totalReferrals>=o.value;break;case"following_count":u=Math.min(100,i.following.length/o.value*100),l=i.following.length>=o.value;break;case"follower_count":u=Math.min(100,i.followers.length/o.value*100),l=i.followers.length>=o.value;break;case"review_count":u=Math.min(100,i.reviewsGiven.length/o.value*100),l=i.reviewsGiven.length>=o.value;break;case"total_valor_earned":u=Math.min(100,i.totalValorEarned/o.value*100),l=i.totalValorEarned>=o.value;break;case"perfect_rating":if(i.swapRequestsSent.length+i.swapRequestsReceived.length>=o.minSwaps){let r=await t.default.review.findMany({where:{targetUserId:e}});if(r.length>0){let e=r.reduce((e,r)=>e+r.rating,0)/r.length;u=Math.min(100,e/5*100),l=e>=o.minRating}}break;case"early_adopter":u=(l=await t.default.user.count({where:{createdAt:{lt:i.createdAt}}})<o.value)?100:0;break;case"category_diversity":let c=new Set(i.products.map(e=>e.categoryId));u=Math.min(100,c.size/o.value*100),l=c.size>=o.value}a[s.slug]=Math.round(u),l&&(await t.default.userBadge.create({data:{userId:e,badgeId:s.id,progress:100}}),s.valorReward>0&&await t.default.user.update({where:{id:e},data:{valorBalance:{increment:s.valorReward},totalValorEarned:{increment:s.valorReward}}}),await t.default.activityFeed.create({data:{type:"badge_earned",userId:e,userName:i.name||i.nickname||i.email.split("@")[0],metadata:JSON.stringify({badgeSlug:s.slug,badgeName:s.name,badgeIcon:s.icon,badgeTier:s.tier,valorReward:s.valorReward}),visibility:"public"}}),r.push(s.slug))}return{awarded:r,progress:a}}catch(e){return console.error("Badge check error:",e),{awarded:r,progress:a}}}async function s(){for(let e of i)await t.default.badge.upsert({where:{slug:e.slug},update:e,create:e});console.log("Badges seeded successfully")}async function o(e){let[r,a]=await Promise.all([t.default.badge.findMany({where:{isActive:!0},orderBy:[{category:"asc"},{sortOrder:"asc"}]}),t.default.userBadge.findMany({where:{userId:e},include:{badge:!0}})]),i=new Set(a.map(e=>e.badge.slug));return r.map(e=>({...e,earned:i.has(e.slug),earnedAt:a.find(r=>r.badge.slug===e.slug)?.earnedAt,isDisplayed:a.find(r=>r.badge.slug===e.slug)?.isDisplayed||!1}))}}};